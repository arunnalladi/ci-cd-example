version: 2
jobs:
  build:
    docker:
      - image: circleci/python:3.6
    steps:
      - checkout
      - run: pip install awscli
      - run: $(aws ecr get-login --no-include-email --region us-west-2)
      - run: docker build -t my-ecr-repo .
      - run: docker tag my-ecr-repo:latest aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-ecr-repo:latest
      - run: docker push aws_account_id.dkr.ecr.us-west-2.amazonaws.com/my-ecr-repo:latest

